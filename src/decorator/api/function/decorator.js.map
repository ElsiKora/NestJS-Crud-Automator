{"version":3,"file":"decorator.js","sourceRoot":"","sources":["decorator.ts"],"names":[],"mappings":"AAKA,OAAO,EAAE,gBAAgB,EAAE,MAAM,eAAe,CAAC;AACjD,OAAO,EAAE,cAAc,EAAE,MAAM,0CAA0C,CAAC;AAE1E,OAAO,EAAE,iBAAiB,EAAE,MAAM,oBAAoB,CAAC;AACvD,OAAO,EAAE,iBAAiB,EAAE,MAAM,oBAAoB,CAAC;AACvD,OAAO,EAAE,kBAAkB,EAAE,MAAM,sBAAsB,CAAC;AAC1D,OAAO,EAAE,kBAAkB,EAAE,MAAM,sBAAsB,CAAC;AAC1D,OAAO,EAAE,cAAc,EAAE,MAAM,iBAAiB,CAAC;AACjD,OAAO,EAAE,iBAAiB,EAAE,MAAM,oBAAoB,CAAC;AAKvD,MAAM,UAAU,WAAW,CAA8B,UAAqC;IAC7F,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,GAA8B,UAAU,CAAC;IAE/D,OAAO,UAAU,OAAgB,EAAE,WAAmB,EAAE,UAA8B;QACrF,MAAM,cAAc,GAAY,UAAU,CAAC,KAAK,CAAC;QAGjD,UAAU,CAAC,KAAK,GAAG,UAA+C,GAAG,UAAsB;YAC1F,IAAI,iBAAqC,CAAC;YAE1C,QAAQ,IAAI,EAAE,CAAC;gBACd,KAAK,gBAAgB,CAAC,MAAM,CAAC,CAAC,CAAC;oBAC9B,iBAAiB,GAAG,iBAAiB,CAAC,EAAE,MAAM,EAAE,CAAC,CAAC;oBAElD,MAAM;gBACP,CAAC;gBAED,KAAK,gBAAgB,CAAC,MAAM,CAAC,CAAC,CAAC;oBAC9B,iBAAiB,GAAG,iBAAiB,CAAC,EAAE,MAAM,EAAE,CAAC,CAAC;oBAElD,MAAM;gBACP,CAAC;gBAED,KAAK,gBAAgB,CAAC,GAAG,CAAC,CAAC,CAAC;oBAC3B,iBAAiB,GAAG,cAAc,CAAC,EAAE,MAAM,EAAE,CAAC,CAAC;oBAE/C,MAAM;gBACP,CAAC;gBAED,KAAK,gBAAgB,CAAC,QAAQ,CAAC,CAAC,CAAC;oBAChC,iBAAiB,GAAG,kBAAkB,CAAC,EAAE,MAAM,EAAE,CAAC,CAAC;oBAEnD,MAAM;gBACP,CAAC;gBAED,KAAK,gBAAgB,CAAC,QAAQ,CAAC,CAAC,CAAC;oBAChC,iBAAiB,GAAG,kBAAkB,CAAC,EAAE,MAAM,EAAE,CAAC,CAAC;oBAEnD,MAAM;gBACP,CAAC;gBAED,KAAK,gBAAgB,CAAC,MAAM,CAAC,CAAC,CAAC;oBAC9B,iBAAiB,GAAG,iBAAiB,CAAC,EAAE,MAAM,EAAE,CAAC,CAAC;oBAElD,MAAM;gBACP,CAAC;gBAED,OAAO,CAAC,CAAC,CAAC;oBACT,MAAM,cAAc,CAAC,sBAAsB,CAAC,CAAC;gBAC9C,CAAC;YACF,CAAC;YAED,MAAM,kBAAkB,GAAuB,iBAAiB,CAAC,IAAI,EAAE,WAAW,EAAE,EAAE,KAAK,EAAE,cAAc,EAAE,CAAC,CAAC;YAC/G,MAAM,cAAc,GAAsC,kBAAkB,CAAC,KAA0C,CAAC;YAExH,OAAO,cAAc,CAAC,KAAK,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC;QAC/C,CAAC,CAAC;QAEF,OAAO,UAAU,CAAC;IACnB,CAAC,CAAC;AACH,CAAC","sourcesContent":["import type { Repository } from \"typeorm\";\n\nimport type { IApiBaseEntity } from \"../../../interface\";\nimport type { TApiFunctionProperties } from \"../../../type\";\n\nimport { EApiFunctionType } from \"../../../enum\";\nimport { ErrorException } from \"../../../utility/error-exception.utility\";\n\nimport { ApiFunctionCreate } from \"./create.decorator\";\nimport { ApiFunctionDelete } from \"./delete.decorator\";\nimport { ApiFunctionGetList } from \"./get-list.decorator\";\nimport { ApiFunctionGetMany } from \"./get-many.decorator\";\nimport { ApiFunctionGet } from \"./get.decorator\";\nimport { ApiFunctionUpdate } from \"./update.decorator\";\n\ntype TDecoratorFunction = (target: any, propertyKey: string, descriptor: PropertyDescriptor) => PropertyDescriptor;\n\n// eslint-disable-next-line @elsikora/typescript/no-unnecessary-type-parameters\nexport function ApiFunction<E extends IApiBaseEntity, R>(properties: TApiFunctionProperties<E>) {\n\tconst { entity, type }: TApiFunctionProperties<E> = properties;\n\n\treturn function (_target: unknown, propertyKey: string, descriptor: PropertyDescriptor): PropertyDescriptor {\n\t\tconst originalMethod: unknown = descriptor.value;\n\n\t\t// eslint-disable-next-line @elsikora/typescript/naming-convention\n\t\tdescriptor.value = function (this: { repository: Repository<E> }, ...arguments_: Array<any>): any {\n\t\t\tlet decoratorFunction: TDecoratorFunction;\n\n\t\t\tswitch (type) {\n\t\t\t\tcase EApiFunctionType.CREATE: {\n\t\t\t\t\tdecoratorFunction = ApiFunctionCreate({ entity });\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase EApiFunctionType.DELETE: {\n\t\t\t\t\tdecoratorFunction = ApiFunctionDelete({ entity });\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase EApiFunctionType.GET: {\n\t\t\t\t\tdecoratorFunction = ApiFunctionGet({ entity });\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase EApiFunctionType.GET_LIST: {\n\t\t\t\t\tdecoratorFunction = ApiFunctionGetList({ entity });\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase EApiFunctionType.GET_MANY: {\n\t\t\t\t\tdecoratorFunction = ApiFunctionGetMany({ entity });\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase EApiFunctionType.UPDATE: {\n\t\t\t\t\tdecoratorFunction = ApiFunctionUpdate({ entity });\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tdefault: {\n\t\t\t\t\tthrow ErrorException(\"Unsupported function\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst modifiedDescriptor: PropertyDescriptor = decoratorFunction(this, propertyKey, { value: originalMethod });\n\t\t\tconst modifiedMethod: (...arguments__: Array<any>) => R = modifiedDescriptor.value as (...arguments__: Array<any>) => R;\n\n\t\t\treturn modifiedMethod.apply(this, arguments_);\n\t\t};\n\n\t\treturn descriptor;\n\t};\n}\n"]}