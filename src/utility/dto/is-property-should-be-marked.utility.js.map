{"version":3,"file":"is-property-should-be-marked.utility.js","sourceRoot":"","sources":["is-property-should-be-marked.utility.ts"],"names":[],"mappings":"AAKA,OAAO,EAAE,WAAW,EAAE,wBAAwB,EAAE,aAAa,EAAE,MAAM,YAAY,CAAC;AAElF,OAAO,EAAE,4BAA4B,EAAE,MAAM,yCAAyC,CAAC;AAEvF,MAAM,UAAU,2BAA2B,CAAC,MAAqB,EAAE,OAAoB,EAAE,YAAoB,EAAE,gBAAgD,EAAE,SAAkB,EAAE,YAA+B;IACnN,MAAM,WAAW,GAAY,CAAC,WAAW,EAAE,YAAY,EAAE,WAAW,CAAC,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;IAE7F,IAAI,MAAM,KAAK,aAAa,CAAC,MAAM,IAAI,OAAO,KAAK,WAAW,CAAC,IAAI,IAAI,WAAW,EAAE,CAAC;QACpF,OAAO,KAAK,CAAC;IACd,CAAC;IAED,MAAM,UAAU,GAAuE,gBAAgB,CAAC,UAAU,EAAE,CAAC,MAAM,CAAuE,CAAC;IAEnM,IAAI,UAAU,EAAE,CAAC,OAAO,CAAC,EAAE,SAAS,KAAK,KAAK,EAAE,CAAC;QAChD,OAAO,KAAK,CAAC;IACd,CAAC;IAED,IAAI,CAAC,4BAA4B,CAAC,MAAM,EAAE,gBAAgB,EAAE,OAAO,EAAE,YAAY,CAAC,EAAE,CAAC;QACpF,OAAO,KAAK,CAAC;IACd,CAAC;IAED,IAAI,OAAO,KAAK,WAAW,CAAC,KAAK,IAAI,gBAAgB,CAAC,IAAI,KAAK,wBAAwB,CAAC,MAAM,EAAE,CAAC;QAChG,OAAO,KAAK,CAAC;IACd,CAAC;IAED,IAAI,OAAO,KAAK,WAAW,CAAC,OAAO,IAAI,SAAS,EAAE,CAAC;QAClD,OAAO,IAAI,CAAC;IACb,CAAC;IAED,IAAI,CAAC,OAAO,KAAK,WAAW,CAAC,KAAK,IAAI,OAAO,KAAK,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC;QACnF,OAAO,IAAI,CAAC;IACb,CAAC;IAED,OAAO,OAAO,KAAK,WAAW,CAAC,OAAO,IAAI,OAAO,KAAK,WAAW,CAAC,KAAK,IAAI,OAAO,KAAK,WAAW,CAAC,IAAI,CAAC;AACzG,CAAC","sourcesContent":["import type { Type } from \"@nestjs/common\";\nimport type { IAuthGuard } from \"@nestjs/passport\";\n\nimport type { TApiPropertyDescribeDtoProperties, TApiPropertyDescribeProperties } from \"../../type\";\n\nimport { EApiDtoType, EApiPropertyDescribeType, EApiRouteType } from \"../../enum\";\n\nimport { DtoIsPropertyExposedForGuard } from \"./is-property-exposed-for-guard.utility\";\n\nexport function DtoIsPropertyShouldBeMarked(method: EApiRouteType, dtoType: EApiDtoType, propertyName: string, propertyMetadata: TApiPropertyDescribeProperties, isPrimary: boolean, currentGuard?: Type<IAuthGuard>): boolean {\n\tconst isDateField: boolean = [\"createdAt\", \"receivedAt\", \"updatedAt\"].includes(propertyName);\n\n\tif (method === EApiRouteType.CREATE && dtoType === EApiDtoType.BODY && isDateField) {\n\t\treturn false;\n\t}\n\n\tconst properties: Record<EApiDtoType, TApiPropertyDescribeDtoProperties> | undefined = propertyMetadata.properties?.[method] as Record<EApiDtoType, TApiPropertyDescribeDtoProperties> | undefined;\n\n\tif (properties?.[dtoType]?.isEnabled === false) {\n\t\treturn false;\n\t}\n\n\tif (!DtoIsPropertyExposedForGuard(method, propertyMetadata, dtoType, currentGuard)) {\n\t\treturn false;\n\t}\n\n\tif (dtoType === EApiDtoType.QUERY && propertyMetadata.type === EApiPropertyDescribeType.OBJECT) {\n\t\treturn false;\n\t}\n\n\tif (dtoType === EApiDtoType.REQUEST && isPrimary) {\n\t\treturn true;\n\t}\n\n\tif ((dtoType === EApiDtoType.QUERY || dtoType === EApiDtoType.BODY) && !isPrimary) {\n\t\treturn true;\n\t}\n\n\treturn dtoType !== EApiDtoType.REQUEST && dtoType !== EApiDtoType.QUERY && dtoType !== EApiDtoType.BODY;\n}\n"]}