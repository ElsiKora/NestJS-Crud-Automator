{"version":3,"file":"apply-metadata.utility.js","sourceRoot":"","sources":["apply-metadata.utility.ts"],"names":[],"mappings":"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","sourcesContent":["import type { Type } from \"@nestjs/common\";\n\nimport type { EApiRouteType } from \"../../../enum\";\nimport type { IApiControllerProperties, IApiEntity } from \"../../../interface\";\nimport type { TApiControllerPropertiesRoute } from \"../../../type\";\n\nimport { assignMetadata } from \"@nestjs/common\";\nimport { PARAMTYPES_METADATA, ROUTE_ARGS_METADATA } from \"@nestjs/common/constants\";\nimport { RouteParamtypes } from \"@nestjs/common/enums/route-paramtypes.enum\";\n\nimport { EApiDtoType } from \"../../../enum\";\nimport { DtoGenerate } from \"../../dto\";\n\nexport function ApiControllerApplyMetadata<E>(target: object, targetPrototype: object, entity: IApiEntity<E>, properties: IApiControllerProperties<E>, method: EApiRouteType, methodName: string, routeConfig: TApiControllerPropertiesRoute<E, typeof method>): void {\n\tlet parameterIndex: number = 0;\n\tlet routeArgumentsMetadata: unknown = {};\n\tconst parameterTypes: Array<any> = [];\n\n\tconst requestDto: Type<unknown> | undefined = routeConfig.dto?.request ?? DtoGenerate(properties.entity, entity, method, EApiDtoType.REQUEST, routeConfig.autoDto?.[EApiDtoType.REQUEST], routeConfig.authentication?.guard);\n\tconst queryDto: Type<unknown> | undefined = routeConfig.dto?.query ?? DtoGenerate(properties.entity, entity, method, EApiDtoType.QUERY, routeConfig.autoDto?.[EApiDtoType.QUERY], routeConfig.authentication?.guard);\n\tconst bodyDto: Type<unknown> | undefined = routeConfig.dto?.body ?? DtoGenerate(properties.entity, entity, method, EApiDtoType.BODY, routeConfig.autoDto?.[EApiDtoType.BODY], routeConfig.authentication?.guard);\n\n\tif (requestDto) {\n\t\trouteArgumentsMetadata = assignMetadata(routeArgumentsMetadata, RouteParamtypes.PARAM, parameterIndex);\n\t\tparameterTypes.push(requestDto);\n\t\tparameterIndex++;\n\t}\n\n\tif (queryDto) {\n\t\trouteArgumentsMetadata = assignMetadata(routeArgumentsMetadata, RouteParamtypes.QUERY, parameterIndex);\n\t\tparameterTypes.push(queryDto);\n\t\tparameterIndex++;\n\t}\n\n\tif (bodyDto) {\n\t\trouteArgumentsMetadata = assignMetadata(routeArgumentsMetadata, RouteParamtypes.BODY, parameterIndex);\n\t\tparameterTypes.push(bodyDto);\n\t\tparameterIndex++;\n\t}\n\n\trouteArgumentsMetadata = assignMetadata(routeArgumentsMetadata, RouteParamtypes.HEADERS, parameterIndex);\n\tparameterTypes.push(Object);\n\tparameterIndex++;\n\n\trouteArgumentsMetadata = assignMetadata(routeArgumentsMetadata, RouteParamtypes.IP, parameterIndex);\n\tparameterTypes.push(Object);\n\tparameterIndex++;\n\n\tif (routeConfig.authentication) {\n\t\trouteArgumentsMetadata = assignMetadata(routeArgumentsMetadata, RouteParamtypes.REQUEST, parameterIndex);\n\t\tparameterTypes.push(Object);\n\t\tparameterIndex++;\n\t}\n\n\tReflect.defineMetadata(ROUTE_ARGS_METADATA, routeArgumentsMetadata, target, methodName);\n\tReflect.defineMetadata(PARAMTYPES_METADATA, parameterTypes, targetPrototype, methodName);\n}\n"]}