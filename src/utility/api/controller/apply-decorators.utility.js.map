{"version":3,"file":"apply-decorators.utility.js","sourceRoot":"","sources":["apply-decorators.utility.ts"],"names":[],"mappings":"AAKA,OAAO,EAAE,UAAU,EAAE,aAAa,EAAE,MAAM,gBAAgB,CAAC;AAE3D,OAAO,EAAE,SAAS,EAAE,MAAM,yCAAyC,CAAC;AACpE,OAAO,EAAE,UAAU,EAAE,WAAW,EAAE,aAAa,EAAE,MAAM,eAAe,CAAC;AACvE,OAAO,EAAE,WAAW,EAAE,MAAM,4BAA4B,CAAC;AACzD,OAAO,EAAE,cAAc,EAAE,MAAM,+BAA+B,CAAC;AAE/D,MAAM,UAAU,4BAA4B,CAAI,YAAoG,EAAE,MAAqB,EAAE,UAAuC,EAAE,MAAqB,EAAE,UAAkB,EAAE,WAA4D,EAAE,UAA6D;IAC3X,MAAM,WAAW,GAA8B,WAAW,CAAC,GAAG,EAAE,QAAQ,IAAI,WAAW,CAAC,UAAU,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,WAAW,CAAC,QAAQ,EAAE,WAAW,CAAC,OAAO,EAAE,CAAC,WAAW,CAAC,QAAQ,CAAC,EAAE,WAAW,CAAC,cAAc,EAAE,KAAK,CAAC,CAAC;IACjO,MAAM,gBAAgB,GAA2B,CAAC,GAAG,UAAU,CAAC,CAAC;IAEjE,QAAQ,MAAM,EAAE,CAAC;QAChB,KAAK,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC;YAC3B,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,MAAM,EAAE,UAAU,CAAC,MAAM,EAAE,cAAc,EAAE,WAAW,CAAC,cAAc,EAAE,MAAM,EAAE,UAAU,CAAC,MAAM,EAAE,QAAQ,EAAE,UAAU,CAAC,OAAO,EAAE,MAAM,EAAE,aAAa,CAAC,IAAI,EAAE,IAAI,EAAE,EAAE,EAAE,SAAS,EAAE,EAAE,sBAAsB,EAAE,IAAI,EAAE,eAAe,EAAE,IAAI,EAAE,EAAE,YAAY,EAAE,WAAW,EAAE,CAAC,CAAC,CAAC;YAE1S,MAAM;QACP,CAAC;QAED,KAAK,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC;YAC3B,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,MAAM,EAAE,UAAU,CAAC,MAAM,EAAE,cAAc,EAAE,WAAW,CAAC,cAAc,EAAE,MAAM,EAAE,UAAU,CAAC,MAAM,EAAE,QAAQ,EAAE,UAAU,CAAC,UAAU,EAAE,MAAM,EAAE,aAAa,CAAC,MAAM,EAAE,IAAI,EAAE,IAAI,MAAM,CAAC,MAAM,CAAC,UAAU,EAAE,IAAI,CAAC,EAAE,EAAE,SAAS,EAAE,EAAE,sBAAsB,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE,eAAe,EAAE,IAAI,EAAE,EAAE,YAAY,EAAE,SAAS,EAAE,CAAC,CAAC,CAAC;YAEnW,MAAM;QACP,CAAC;QAED,KAAK,aAAa,CAAC,GAAG,CAAC,CAAC,CAAC;YACxB,gBAAgB,CAAC,IAAI,CACpB,SAAS,CAAC;gBACT,MAAM,EAAE,UAAU,CAAC,KAAK;gBACxB,cAAc,EAAE,WAAW,CAAC,cAAc;gBAC1C,MAAM,EAAE,UAAU,CAAC,MAAM;gBACzB,QAAQ,EAAE,UAAU,CAAC,EAAE;gBACvB,MAAM,EAAE,aAAa,CAAC,GAAG;gBACzB,IAAI,EAAE,IAAI,MAAM,CAAC,MAAM,CAAC,UAAU,EAAE,IAAI,CAAC,EAAE;gBAC3C,SAAS,EAAE,EAAE,sBAAsB,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE,eAAe,EAAE,IAAI,EAAE;gBACrF,YAAY,EAAE,WAAW;aACzB,CAAC,CACF,CAAC;YAEF,MAAM;QACP,CAAC;QAED,KAAK,aAAa,CAAC,QAAQ,CAAC,CAAC,CAAC;YAC7B,gBAAgB,CAAC,IAAI,CACpB,SAAS,CAAC;gBACT,MAAM,EAAE,UAAU,CAAC,UAAU;gBAC7B,cAAc,EAAE,WAAW,CAAC,cAAc;gBAC1C,MAAM,EAAE,UAAU,CAAC,MAAM;gBACzB,QAAQ,EAAE,UAAU,CAAC,EAAE;gBACvB,MAAM,EAAE,aAAa,CAAC,GAAG;gBACzB,IAAI,EAAE,EAAE;gBACR,SAAS,EAAE,EAAE,sBAAsB,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE,eAAe,EAAE,IAAI,EAAE;gBACrF,YAAY,EAAE,WAAW;aACzB,CAAC,CACF,CAAC;YAEF,MAAM;QACP,CAAC;QAED,KAAK,aAAa,CAAC,cAAc,CAAC,CAAC,CAAC;YACnC,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,MAAM,EAAE,UAAU,CAAC,MAAM,EAAE,cAAc,EAAE,WAAW,CAAC,cAAc,EAAE,MAAM,EAAE,UAAU,CAAC,MAAM,EAAE,QAAQ,EAAE,UAAU,CAAC,EAAE,EAAE,MAAM,EAAE,aAAa,CAAC,KAAK,EAAE,IAAI,EAAE,IAAI,MAAM,CAAC,MAAM,CAAC,UAAU,EAAE,IAAI,CAAC,EAAE,EAAE,SAAS,EAAE,EAAE,aAAa,EAAE,IAAI,EAAE,sBAAsB,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE,eAAe,EAAE,IAAI,EAAE,EAAE,YAAY,EAAE,WAAW,EAAE,CAAC,CAAC,CAAC;YAEjX,MAAM;QACP,CAAC;QAED,KAAK,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC;YAC3B,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,MAAM,EAAE,UAAU,CAAC,MAAM,EAAE,cAAc,EAAE,WAAW,CAAC,cAAc,EAAE,MAAM,EAAE,UAAU,CAAC,MAAM,EAAE,QAAQ,EAAE,UAAU,CAAC,EAAE,EAAE,MAAM,EAAE,aAAa,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,MAAM,CAAC,MAAM,CAAC,UAAU,EAAE,IAAI,CAAC,EAAE,EAAE,SAAS,EAAE,EAAE,aAAa,EAAE,IAAI,EAAE,sBAAsB,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE,eAAe,EAAE,IAAI,EAAE,EAAE,YAAY,EAAE,WAAW,EAAE,CAAC,CAAC,CAAC;YAE/W,MAAM;QACP,CAAC;QAED,OAAO,CAAC,CAAC,CAAC;YACT,MAAM,cAAc,CAAC,UAAU,MAAgB,kBAAkB,CAAC,CAAC;QACpE,CAAC;IACF,CAAC;IAED,IAAI,gBAAgB,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;QACjC,KAAK,MAAM,SAAS,IAAI,gBAAgB,EAAE,CAAC;YAC1C,MAAM,UAAU,GAA6C,OAAO,CAAC,wBAAwB,CAAC,YAAY,EAAE,UAAU,CAAC,CAAC;YACvH,SAAiD,CAAC,YAAY,EAAE,UAAU,EAAE,UAAU,IAAI,EAAE,KAAK,EAAE,YAAY,EAAE,CAAC,CAAC;QACrH,CAAC;IACF,CAAC;AACF,CAAC","sourcesContent":["import type { Type } from \"@nestjs/common\";\n\nimport type { IApiControllerProperties, IApiEntity } from \"../../../interface\";\nimport type { TApiControllerPropertiesRoute } from \"../../../type\";\n\nimport { HttpStatus, RequestMethod } from \"@nestjs/common\";\n\nimport { ApiMethod } from \"../../../decorator/api/method.decorator\";\nimport { EApiAction, EApiDtoType, EApiRouteType } from \"../../../enum\";\nimport { DtoGenerate } from \"../../dto/generate.utility\";\nimport { ErrorException } from \"../../error-exception.utility\";\n\nexport function ApiControllerApplyDecorators<E>(targetMethod: (properties: any, body: any, headers: any, ip: any, authenticationRequest: any) => any, entity: IApiEntity<E>, properties: IApiControllerProperties<E>, method: EApiRouteType, methodName: string, routeConfig: TApiControllerPropertiesRoute<E, typeof method>, decorators: Array<MethodDecorator> | Array<PropertyDecorator>): void {\n\tconst responseDto: Type<unknown> | undefined = routeConfig.dto?.response ?? DtoGenerate(properties.entity, entity, method, EApiDtoType.RESPONSE, routeConfig.autoDto?.[EApiDtoType.RESPONSE], routeConfig.authentication?.guard);\n\tconst customDecorators: Array<MethodDecorator> = [...decorators];\n\n\tswitch (method) {\n\t\tcase EApiRouteType.CREATE: {\n\t\t\tcustomDecorators.push(ApiMethod({ action: EApiAction.CREATE, authentication: routeConfig.authentication, entity: properties.entity, httpCode: HttpStatus.CREATED, method: RequestMethod.POST, path: \"\", responses: { hasInternalServerError: true, hasUnauthorized: true }, responseType: responseDto }));\n\n\t\t\tbreak;\n\t\t}\n\n\t\tcase EApiRouteType.DELETE: {\n\t\t\tcustomDecorators.push(ApiMethod({ action: EApiAction.DELETE, authentication: routeConfig.authentication, entity: properties.entity, httpCode: HttpStatus.NO_CONTENT, method: RequestMethod.DELETE, path: `:${String(entity.primaryKey?.name)}`, responses: { hasInternalServerError: true, hasNotFound: true, hasUnauthorized: true }, responseType: undefined }));\n\n\t\t\tbreak;\n\t\t}\n\n\t\tcase EApiRouteType.GET: {\n\t\t\tcustomDecorators.push(\n\t\t\t\tApiMethod({\n\t\t\t\t\taction: EApiAction.FETCH,\n\t\t\t\t\tauthentication: routeConfig.authentication,\n\t\t\t\t\tentity: properties.entity,\n\t\t\t\t\thttpCode: HttpStatus.OK,\n\t\t\t\t\tmethod: RequestMethod.GET,\n\t\t\t\t\tpath: `:${String(entity.primaryKey?.name)}`,\n\t\t\t\t\tresponses: { hasInternalServerError: true, hasNotFound: true, hasUnauthorized: true },\n\t\t\t\t\tresponseType: responseDto,\n\t\t\t\t}),\n\t\t\t);\n\n\t\t\tbreak;\n\t\t}\n\n\t\tcase EApiRouteType.GET_LIST: {\n\t\t\tcustomDecorators.push(\n\t\t\t\tApiMethod({\n\t\t\t\t\taction: EApiAction.FETCH_LIST,\n\t\t\t\t\tauthentication: routeConfig.authentication,\n\t\t\t\t\tentity: properties.entity,\n\t\t\t\t\thttpCode: HttpStatus.OK,\n\t\t\t\t\tmethod: RequestMethod.GET,\n\t\t\t\t\tpath: \"\",\n\t\t\t\t\tresponses: { hasInternalServerError: true, hasNotFound: true, hasUnauthorized: true },\n\t\t\t\t\tresponseType: responseDto,\n\t\t\t\t}),\n\t\t\t);\n\n\t\t\tbreak;\n\t\t}\n\n\t\tcase EApiRouteType.PARTIAL_UPDATE: {\n\t\t\tcustomDecorators.push(ApiMethod({ action: EApiAction.UPDATE, authentication: routeConfig.authentication, entity: properties.entity, httpCode: HttpStatus.OK, method: RequestMethod.PATCH, path: `:${String(entity.primaryKey?.name)}`, responses: { hasBadRequest: true, hasInternalServerError: true, hasNotFound: true, hasUnauthorized: true }, responseType: responseDto }));\n\n\t\t\tbreak;\n\t\t}\n\n\t\tcase EApiRouteType.UPDATE: {\n\t\t\tcustomDecorators.push(ApiMethod({ action: EApiAction.UPDATE, authentication: routeConfig.authentication, entity: properties.entity, httpCode: HttpStatus.OK, method: RequestMethod.PUT, path: `:${String(entity.primaryKey?.name)}`, responses: { hasBadRequest: true, hasInternalServerError: true, hasNotFound: true, hasUnauthorized: true }, responseType: responseDto }));\n\n\t\t\tbreak;\n\t\t}\n\n\t\tdefault: {\n\t\t\tthrow ErrorException(`Method ${method as string} not implemented`);\n\t\t}\n\t}\n\n\tif (customDecorators.length > 0) {\n\t\tfor (const decorator of customDecorators) {\n\t\t\tconst descriptor: TypedPropertyDescriptor<any> | undefined = Reflect.getOwnPropertyDescriptor(targetMethod, methodName);\n\t\t\t(decorator as MethodDecorator | PropertyDecorator)(targetMethod, methodName, descriptor ?? { value: targetMethod });\n\t\t}\n\t}\n}\n"]}